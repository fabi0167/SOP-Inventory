<app-navbar></app-navbar>

<div class="container mt-4">
  <h2 class="mb-4">Dashboard</h2>

  <div *ngIf="isLoading" class="alert alert-info" role="alert">
    Indlæser dashboarddata...
  </div>

  <div *ngIf="errorMessage" class="alert alert-danger" role="alert">
    {{ errorMessage }}
  </div>

  <div *ngIf="!isLoading && !errorMessage && summary" class="row g-3">
    <div class="col-12">
      <div class="card shadow-sm h-100">
        <div class="card-body">
          <h5 class="card-title">Hurtigt overblik</h5>
          <div class="status-grid quick-stats-grid">
            <div class="status-card emphasis-card quick-stat-card">
              <p class="status-name">Samlet antal genstande</p>
              <p class="status-count">{{ summary.totalItemCount }}</p>
            </div>
            <button type="button" class="status-card status-card-link quick-stat-card" (click)="goToActiveLoans()">
              <span class="visually-hidden">Gå til aktive udlån</span>
              <p class="status-name">Aktive udlån</p>
              <p class="status-count">{{ summary.activeLoanCount }}</p>
            </button>
            <div class="status-card warning-card quick-stat-card">
              <p class="status-name">Ikke-fungerende genstande</p>
              <p class="status-count">{{ summary.nonFunctionalItemCount }}</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="col-12">
      <div class="card shadow-sm h-100">
        <div class="card-body">
          <h5 class="card-title">Genstande efter status</h5>
          <div class="status-grid">
            <ng-container *ngFor="let status of getStatusCounts(); trackBy: trackStatusBy">
              <button
                *ngIf="isStatusClickable(status.status)"
                type="button"
                class="status-card status-card-link"
                (click)="goToStatusItems(status.status)"
              >
                <span class="visually-hidden">Se genstande med status {{ status.status }}</span>
                <p class="status-name">{{ getStatusDisplayName(status.status) }}</p>
                <p class="status-count">{{ status.count }}</p>
              </button>
              <div *ngIf="!isStatusClickable(status.status)" class="status-card">
                <p class="status-name">{{ getStatusDisplayName(status.status) }}</p>
                <p class="status-count">{{ status.count }}</p>
              </div>
            </ng-container>
            <div *ngIf="getStatusCounts().length === 0" class="text-muted status-empty">
              Ingen statusdata tilgængelig.
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="col-12">
      <div class="card shadow-sm h-100">
        <div class="card-body">
          <h5 class="card-title">Hurtigt overblik</h5>
          <div class="status-grid quick-stats-grid">
            <div class="status-card emphasis-card">
              <p class="status-name">Udlånte genstande</p>
              <p class="status-count">{{ summary.borrowedItemCount }}</p>
            </div>
            <div class="status-card emphasis-card">
              <p class="status-name">Ikke-fungerende genstande</p>
              <p class="status-count">{{ summary.nonFunctionalItemCount }}</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
